<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Retro Pong O'yini</title>
<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    color: #0f0;
    font-family: 'Courier New', Courier, monospace;
    user-select: none;
  }
  h1 {
    margin-bottom: 10px;
    text-shadow: 0 0 5px #0f0;
  }
  canvas {
    background: #111;
    border: 3px solid #0f0;
    border-radius: 10px;
    display: block;
  }
  #score {
    margin-top: 10px;
    font-size: 20px;
    font-weight: bold;
    text-shadow: 0 0 10px #0f0;
    display: flex;
    gap: 40px;
    width: 320px;
    justify-content: center;
  }
  #controls {
    margin-top: 15px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    max-width: 320px;
    justify-content: center;
  }
  .btn {
    background: #000;
    border: 2px solid #0f0;
    border-radius: 6px;
    color: #0f0;
    font-size: 18px;
    font-weight: bold;
    padding: 12px 18px;
    cursor: pointer;
    user-select: none;
    width: 70px;
    text-align: center;
    box-shadow: 0 0 8px #0f0;
    transition: all 0.2s ease;
  }
  .btn:active {
    background: #0f0;
    color: #000;
    box-shadow: none;
  }
  #modal {
    position: fixed;
    top: 0; left: 0; right:0; bottom:0;
    background: rgba(0,0,0,0.9);
    display: flex;
    justify-content: center;
    align-items: center;
    color: #0f0;
    font-size: 24px;
    font-weight: bold;
    flex-direction: column;
    gap: 20px;
    z-index: 9999;
    display: none;
  }
  #modal button {
    padding: 10px 25px;
    font-size: 18px;
    font-weight: bold;
    border-radius: 8px;
    border: none;
    background: #0f0;
    color: #000;
    cursor: pointer;
    box-shadow: 0 0 10px #0f0;
  }

  /* Yangi: Yuklanmoqda animatsiyasi */
  #loadingScreen {
    position: fixed;
    top: 0; left:0; right:0; bottom:0;
    background: #000;
    color: #0f0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 28px;
    font-weight: bold;
    z-index: 10000;
  }
  #loadingDots {
    font-size: 40px;
    margin-top: 15px;
    animation: blink 1s infinite;
  }
  @keyframes blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0; }
  }
</style>
</head>
<body>

<h1>Retro Pong</h1>
<canvas id="game" width="320" height="240"></canvas>
<div id="score"><div id="playerScore">Siz: 0</div><div id="aiScore">FERKAVEKA: 0</div></div>

<div id="controls">
  <div class="btn" id="upBtn">↑</div>
  <div class="btn" id="downBtn">↓</div>
</div>

<div id="modal">
  <div id="modalText">O'yin tugadi!</div>
  <button id="restartBtn">Qayta boshlash</button>
</div>

<!-- Yuklanmoqda ekrani -->
<div id="loadingScreen">
  Yuklanmoqda
  <div id="loadingDots">...</div>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

const paddleWidth = 10;
const paddleHeight = 50;
const ballRadius = 7;

let playerY = (canvas.height - paddleHeight) / 2;
let aiY = (canvas.height - paddleHeight) / 2;

let ballX = canvas.width / 2;
let ballY = canvas.height / 2;
let ballSpeedX = 4;
let ballSpeedY = 4;

let playerScore = 0;
let aiScore = 0;

const loadingScreen = document.getElementById('loadingScreen');

// O'yinni chizish funksiyalari
function drawRect(x, y, w, h, color) { ctx.fillStyle=color; ctx.fillRect(x,y,w,h); }
function drawCircle(x,y,r,color){ ctx.fillStyle=color; ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill(); }
function drawNet(){ ctx.strokeStyle='#0f0'; ctx.lineWidth=2; ctx.setLineDash([10,10]); ctx.beginPath(); ctx.moveTo(canvas.width/2,0); ctx.lineTo(canvas.width/2,canvas.height); ctx.stroke(); ctx.setLineDash([]); }
function draw(){
  drawRect(0,0,canvas.width,canvas.height,'#111');
  drawNet();
  drawRect(0,playerY,paddleWidth,paddleHeight,'#0f0');
  drawRect(canvas.width - paddleWidth, aiY,paddleWidth,paddleHeight,'#0f0');
  drawCircle(ballX,ballY,ballRadius,'#0f0');
}

function update(){
  ballX += ballSpeedX;
  ballY += ballSpeedY;

  if(ballY + ballRadius > canvas.height || ballY - ballRadius <0){ ballSpeedY=-ballSpeedY; }

  if(ballX - ballRadius < paddleWidth){
    if(ballY > playerY && ballY < playerY+paddleHeight){
      ballSpeedX=-ballSpeedX; ballSpeedX*=1.05; ballSpeedY*=1.05;
    } else { aiScore++; updateScore(); resetBall(); }
  }
  if(ballX + ballRadius > canvas.width - paddleWidth){
    if(ballY > aiY && ballY < aiY + paddleHeight){
      ballSpeedX=-ballSpeedX; ballSpeedX*=1.05; ballSpeedY*=1.05;
    } else { playerScore++; updateScore(); resetBall(); }
  }

  if(aiY + paddleHeight/2 < ballY) aiY +=3; else aiY -=3;
  if(aiY<0) aiY=0; if(aiY+paddleHeight>canvas.height) aiY=canvas.height - paddleHeight;

  draw();

  if(playerScore>=10) endGame('Siz yutdingiz!');
  if(aiScore>=10) endGame('FERKAVEKA yutdi ha ha !');
}

function resetBall(){
  ballX = canvas.width/2;
  ballY = canvas.height/2;
  ballSpeedX = (Math.random()>0.5?1:-1)*4;
  ballSpeedY = (Math.random()*4)-2;
}

let animationId;
function gameLoop(){
  update();
  animationId=requestAnimationFrame(gameLoop);
}

function updateScore(){
  document.getElementById('playerScore').innerText='Siz: '+playerScore;
  document.getElementById('aiScore').innerText='AI: '+aiScore;
}

// O'yin tugashi
const modal=document.getElementById('modal');
const modalText=document.getElementById('modalText');
const restartBtn=document.getElementById('restartBtn');

function endGame(text){
  cancelAnimationFrame(animationId);
  modalText.textContent=text;
  modal.style.display='flex';
}

restartBtn.addEventListener('click', ()=>{
  modal.style.display='none';
  playerScore=0; aiScore=0;
  updateScore();
  resetBall();
  gameLoop();
});

// Player klaviatura harakati
window.addEventListener('keydown', e=>{
  if(e.key==='ArrowUp'){ playerY-=40; if(playerY<0) playerY=0; }
  else if(e.key==='ArrowDown'){ playerY+=40; if(playerY+paddleHeight>canvas.height) playerY=canvas.height - paddleHeight; }
});

// Telefon tugmalari
document.getElementById('upBtn').addEventListener('touchstart', e=>{ e.preventDefault(); playerY-=40; if(playerY<0) playerY=0; });
document.getElementById('downBtn').addEventListener('touchstart', e=>{ e.preventDefault(); playerY+=40; if(playerY+paddleHeight>canvas.height) playerY=canvas.height - paddleHeight; });

// **Yuklanmoqda animatsiyasi**
let loadCount = 0;
const loadingDots = document.getElementById('loadingDots');
const loadingInterval = setInterval(()=>{
  loadCount=(loadCount+1)%4;
  loadingDots.textContent='.'.repeat(loadCount);
}, 500);

setTimeout(()=>{
  clearInterval(loadingInterval);
  loadingScreen.style.display='none';
  resetBall();
  gameLoop();
}, 3000); // 3 soniya yuklanadi

</script>

</body>
</html>
